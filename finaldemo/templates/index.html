<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>智能助教系统</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
  <header class="header">
    <div class="container">
      <div class="logo">
        <i class="fa fa-graduation-cap"></i>
        <h1>智能助教系统</h1>
      </div>
    </div>
  </header>

  <main class="main">
    <section class="hero">
      <div class="container">
        <h2>智能知识图谱生成系统</h2>
        <p>上传学习资料，自动生成知识图谱，提升学习效率</p>
      </div>
    </section>

    <section class="upload-section">
      <div class="container">
        <div class="upload-area">
          <i class="fa fa-cloud-upload"></i>
          <h3>上传学习资料</h3>
          <p>支持PPT、PDF、Word、TXT格式</p>
          
          <div class="node-count-input">
            <label for="nodeCountInput">期望节点数量（可选）:</label>
            <input type="number" id="nodeCountInput" min="0" placeholder="0表示不限制">
          </div>
          
          <label for="fileInput" class="upload-btn">
            <i class="fa fa-file-text-o"></i>选择文件
            <input id="fileInput" type="file" accept=".ppt,.pptx,.pdf,.docx,.doc,.txt">
          </label>
        </div>
      </div>

        <div id="progressContainer" class="hidden">
          <div class="progress-card">
            <div class="progress-header">
              <h3>正在处理文档</h3>
              <span id="progressPercentage">0%</span>
            </div>
            <div class="progress-bar">
              <div id="progressBar"></div>
            </div>
            <div class="progress-message">
              <i class="fa fa-spinner fa-spin"></i>
              <p id="progressMessage">准备处理文档...</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 在graph-section部分添加节点控制UI -->
    <section class="graph-section">
      <div id="graphContainer" class="hidden">
        <div class="graph-header">
          <h3>知识图谱</h3>
          <div class="graph-controls">
            <div class="search-box">
              <i class="fa fa-search"></i>
              <input type="text" id="searchNode" placeholder="搜索知识点...">
            </div>
            
            <div class="action-buttons">
              <button id="regenerateBtn" class="action-btn">
                <i class="fa fa-refresh"></i> 重新生成
              </button>
              <button id="ignoreNodeBtn" class="action-btn">
                <i class="fa fa-eye-slash"></i> 忽略节点
              </button>
              <button id="resetIgnoredBtn" class="action-btn">
                <i class="fa fa-eye"></i> 重置忽略
              </button>
            </div>
            
            <button id="refreshGraph" class="icon-btn">
              <i class="fa fa-refresh"></i>
            </button>
          </div>
        </div>

        <div id="networkContainer"></div>

        <div class="graph-footer">
          <div class="legend">
            <div class="legend-item">
              <div class="color mastered"></div>
              <span>已掌握</span>
            </div>
            <div class="legend-item">
              <div class="color partial"></div>
              <span>部分掌握</span>
            </div>
            <div class="legend-item">
              <div class="color unmastered"></div>
              <span>未掌握</span>
            </div>
          </div>
          <div class="stats">
            <span>节点: <span id="nodeCount">0</span></span>
            <span>边: <span id="edgeCount">0</span></span>
          </div>
        </div>
      </div>
    </section>

    <section class="quiz-section">
      <div id="quizContainer" class="hidden">
        <div class="quiz-header">
          <h3>知识测试</h3>
          <p>回答问题，巩固你的理解</p>
        </div>
        <div class="quiz-body">
          <div id="questionCard" class="hidden">
            <div class="question-box">
              <h4>问题</h4>
              <p id="currentQuestion"></p>
            </div>
            <div class="answer-box">
              <h4>你的回答</h4>
              <textarea id="userAnswer" placeholder="请输入你的回答..."></textarea>
            </div>
            <button id="submitAnswer">提交答案</button>
          </div>
          
          <div id="answerFeedback" class="hidden">
            <div class="feedback-box" id="feedbackCard">
              <h4 id="feedbackTitle"></h4>
              <p id="feedbackText"></p>
            </div>
            <button id="nextQuestion">下一个问题</button>
          </div>
          
          <div id="noQuestion">
            <i class="fa fa-question-circle"></i>
            <h4>请先选择一个知识点</h4>
            <p>在知识图谱中点击一个节点，开始测试</p>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="container">
      <p>© 2025 智能助教系统 | 知识图谱学习平台</p>
    </div>
  </footer>

  <!-- 修改后的Font Awesome链接 -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js" crossorigin="anonymous"></script>
  <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
  <script src="{{ url_for('static', filename='js/script.js') }}"></script>
  
  <!-- 上下文模态框 -->
  <div id="contextModal" class="context-modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">原文上下文</h3>
        <button id="closeContextModal" class="close-modal">&times;</button>
      </div>
      <div class="modal-body" id="contextContent"></div>
    </div>
  </div>
</body>
</html>